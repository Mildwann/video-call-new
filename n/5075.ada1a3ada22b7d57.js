"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5075],{5075:(F,M,d)=>{d.r(M),d.d(M,{HomePageModule:()=>V});var b=d(177),p=d(7125),x=d(4341),h=d(7291),g=d(467),e=d(4020),C=d(3656),k=d(4617);const O=["localVideo"];function S(i,l){if(1&i&&(e.j41(0,"ion-badge",38),e.EFF(1),e.k0s()),2&i){const c=e.XpG();e.R7$(),e.JRh(c.remoteStreams.length+1)}}function w(i,l){if(1&i&&(e.j41(0,"div",39)(1,"div",16),e.nrm(2,"video",40),e.j41(3,"div",18)(4,"div",19)(5,"span",20),e.EFF(6),e.k0s(),e.nrm(7,"div",41),e.k0s()()()()),2&i){const c=l.$implicit;e.R7$(2),e.Y8G("srcObject",c.stream),e.R7$(4),e.JRh(c.peerId)}}function j(i,l){if(1&i&&(e.j41(0,"div",27)(1,"div",28),e.nrm(2,"ion-icon",29),e.k0s(),e.j41(3,"div",30)(4,"strong"),e.EFF(5),e.k0s(),e.nrm(6,"div",31),e.k0s()()),2&i){const c=l.$implicit;e.R7$(5),e.JRh(c.peerId)}}const y=[{path:"",component:(()=>{var i;class l{constructor(t,n,o,r,m){this.route=t,this.alertController=n,this.router2=o,this.platform=r,this.PeerserviceService=m,this.localStream=null,this.remoteStream=null,this.remoteStreams=[],this.connectedPeers=new Set,this.peerIdToCall="",this.peerId="",this.isMicMuted=!1,this.isVideoEnabled=!0,this.isCallActive=!1,this.isSpeakerView=!1,this.showParticipants=!1,this.isSharingScreen=!1,this.peerIdOfCaller="",this.isMiniView=!1,this.route.paramMap.subscribe(s=>{const a=s.get("peerIdCall");a&&(this.peerIdToCall=a,this.PeerserviceService.callPeer(a))}),this.PeerserviceService.remoteStream$.subscribe(s=>{this.remoteStreams=s?[{stream:s,peerId:this.peerIdToCall}]:[]}),this.PeerserviceService.localStream$.subscribe(s=>{var a;this.localStream=s,null!==(a=this.localVideo)&&void 0!==a&&a.nativeElement&&(this.localVideo.nativeElement.srcObject=s)}),this.PeerserviceService.remoteStream$.subscribe(s=>{this.remoteStream=s}),this.initializeMediaStream()}goToHome(){let t=this.route.snapshot.paramMap.get("peerIdCall")||this.peerIdOfCaller;""!=this.peerIdOfCaller&&(t=this.peerIdOfCaller);const n={state:{showMiniView:!0,peerId:this.peerId,isCallActive:this.isCallActive,remoteStreamsCount:this.remoteStreams.length,peerIdOfCaller:t}};console.log("peerIdOfCaller from URL or fallback:",t),this.router2.navigate(["/firstpage"],n)}ngOnInit(){return(0,g.A)(function*(){})()}ngOnDestroy(){}get isAndroidApp(){return this.platform.is("android")}ngAfterViewInit(){}toggleParticipants(){this.showParticipants=!this.showParticipants}updateParticipantStatus(t,n,o){const r=this.remoteStreams.find(m=>m.peerId===t);r&&(r.isMuted=n,r.isVideoOn=o)}shareScreen(){var t=this;return(0,g.A)(function*(){try{var n,o;const r=null===(n=t.localStream)||void 0===n?void 0:n.getVideoTracks()[0];r&&(r.enabled=!1);const m=yield navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}),s=new MediaStream;null===(o=t.localStream)||void 0===o||o.getAudioTracks().forEach(a=>s.addTrack(a)),m.getVideoTracks().forEach(a=>s.addTrack(a)),r&&s.addTrack(r),t.localStream=s,t.localVideo.nativeElement.srcObject=t.localStream,t.remoteStreams.forEach(a=>{if(a.call){const u=a.call.peerConnection.getSenders().find(_=>{var f;return"video"===(null===(f=_.track)||void 0===f?void 0:f.kind)});u&&u.replaceTrack(t.localStream.getVideoTracks()[0])}}),m.getVideoTracks()[0].onended=()=>{var a;const v=new MediaStream;null===(a=t.localStream)||void 0===a||a.getAudioTracks().forEach(u=>v.addTrack(u)),r&&(r.enabled=!0,v.addTrack(r)),t.localStream=v,t.localVideo.nativeElement.srcObject=t.localStream,t.remoteStreams.forEach(u=>{if(u.call){const f=u.call.peerConnection.getSenders().find(E=>{var P;return"video"===(null===(P=E.track)||void 0===P?void 0:P.kind)});f&&r&&f.replaceTrack(r)}})}}catch(r){console.error("Error sharing screen:",r)}})()}toggleSpeakerView(){this.isSpeakerView=!this.isSpeakerView}initializeMediaStream(){var t=this;return(0,g.A)(function*(){try{var n;t.localStream=yield t.PeerserviceService.initializeLocalStream(),null!==(n=t.localVideo)&&void 0!==n&&n.nativeElement&&(t.localVideo.nativeElement.srcObject=t.localStream),t.localVideo&&(t.localVideo.nativeElement.muted=!0)}catch(o){console.error("Error initializing media:",o)}})()}toggleMic(){var t=this;return(0,g.A)(function*(){t.isMicMuted=!t.isMicMuted,t.PeerserviceService.toggleMic()})()}toggleVideo(){var t=this;return(0,g.A)(function*(){t.isVideoEnabled=!t.isVideoEnabled,t.PeerserviceService.toggleVideo()})()}endCall(){var t=this;return(0,g.A)(function*(){t.remoteStreams.forEach(o=>{o.call&&o.call.close()}),t.localStream&&(t.localStream.getTracks().forEach(o=>o.stop()),t.localStream=null),t.remoteStreams=[],t.connectedPeers.clear(),t.isCallActive=!1,t.router2.navigate(["/firstpage"],{state:{reload:!0}})})()}copyPeerId(){var t=this;return(0,g.A)(function*(){if(t.PeerserviceService.peerId$.subscribe(n=>{t.peerId=n}),t.peerId)try{yield navigator.clipboard.writeText(t.peerId),t.showAlert("Copied","Peer ID copied to clipboard")}catch(n){console.error("Failed to copy:",n),t.showAlert("Error","Failed to copy Peer ID")}})()}showAlert(t,n,o){var r=this;return(0,g.A)(function*(){yield(yield r.alertController.create({header:t,message:n,buttons:["OK"]})).present()})()}}return(i=l).\u0275fac=function(t){return new(t||i)(e.rXU(h.nX),e.rXU(p.hG),e.rXU(h.Ix),e.rXU(C.OD),e.rXU(k.J))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-home"]],viewQuery:function(t,n){if(1&t&&e.GBs(O,5),2&t){let o;e.mGM(o=e.lsd())&&(n.localVideo=o.first)}},standalone:!1,decls:59,vars:14,consts:[["localVideo",""],[1,"header-toolbar"],["slot","start"],["fill","clear",1,"back-button",3,"click"],["name","arrow-back"],[1,"meeting-title"],["slot","end"],["fill","clear",1,"control-button",3,"click"],["name","people-outline"],["color","danger",4,"ngIf"],["fill","clear",1,"control-button","room-id-button",3,"click"],["name","copy-outline"],[1,"button-label"],[1,"meeting-container"],[1,"video-grid"],[1,"video-item","local-video"],[1,"video-container"],["autoplay","","playsinline","","muted","true"],[1,"video-overlay"],[1,"user-info"],[1,"peer-id"],["class","video-item",4,"ngFor","ngForOf"],[1,"participants-panel"],[1,"panel-header"],["fill","clear",3,"click"],["name","close"],[1,"participants-list"],[1,"participant-item"],[1,"avatar"],["name","person-circle"],[1,"participant-details"],[1,"status"],["class","participant-item",4,"ngFor","ngForOf"],[1,"meeting-controls"],[1,"controls-container"],[3,"name"],["fill","clear",1,"control-button","end-call",3,"click"],["name","call-outline"],["color","danger"],[1,"video-item"],["autoplay","","playsinline","",3,"srcObject"],[1,"status-indicators"]],template:function(t,n){if(1&t){const o=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),e.bIt("click",function(){return e.eBV(o),e.Njj(n.goToHome())}),e.nrm(4,"ion-icon",4),e.k0s()(),e.j41(5,"ion-title",5),e.EFF(6,"Video Meeting"),e.k0s(),e.j41(7,"ion-buttons",6)(8,"ion-button",7),e.bIt("click",function(){return e.eBV(o),e.Njj(n.toggleParticipants())}),e.nrm(9,"ion-icon",8),e.DNE(10,S,2,1,"ion-badge",9),e.k0s(),e.j41(11,"ion-button",10),e.bIt("click",function(){return e.eBV(o),e.Njj(n.copyPeerId())}),e.nrm(12,"ion-icon",11),e.j41(13,"span",12),e.EFF(14,"Room ID"),e.k0s()()()()(),e.j41(15,"ion-content",13)(16,"div",14)(17,"div",15)(18,"div",16),e.nrm(19,"video",17,0),e.j41(21,"div",18)(22,"div",19)(23,"span",20),e.EFF(24,"You"),e.k0s()()()()(),e.DNE(25,w,8,2,"div",21),e.k0s(),e.j41(26,"div",22)(27,"div",23)(28,"h3"),e.EFF(29),e.k0s(),e.j41(30,"ion-button",24),e.bIt("click",function(){return e.eBV(o),e.Njj(n.toggleParticipants())}),e.nrm(31,"ion-icon",25),e.k0s()(),e.j41(32,"div",26)(33,"div",27)(34,"div",28),e.nrm(35,"ion-icon",29),e.k0s(),e.j41(36,"div",30)(37,"strong"),e.EFF(38,"You"),e.k0s(),e.nrm(39,"div",31),e.k0s()(),e.DNE(40,j,7,1,"div",32),e.k0s()(),e.j41(41,"div",33)(42,"div",34)(43,"ion-button",7),e.bIt("click",function(){return e.eBV(o),e.Njj(n.toggleMic())}),e.nrm(44,"ion-icon",35),e.j41(45,"span",12),e.EFF(46),e.k0s()(),e.j41(47,"ion-button",7),e.bIt("click",function(){return e.eBV(o),e.Njj(n.toggleVideo())}),e.nrm(48,"ion-icon",35),e.j41(49,"span",12),e.EFF(50),e.k0s()(),e.j41(51,"ion-button",7),e.bIt("click",function(){return e.eBV(o),e.Njj(n.shareScreen())}),e.nrm(52,"ion-icon",35),e.j41(53,"span",12),e.EFF(54),e.k0s()(),e.j41(55,"ion-button",36),e.bIt("click",function(){return e.eBV(o),e.Njj(n.endCall())}),e.nrm(56,"ion-icon",37),e.j41(57,"span",12),e.EFF(58,"Leave"),e.k0s()()()()()}2&t&&(e.R7$(10),e.Y8G("ngIf",n.remoteStreams.length>0),e.R7$(6),e.AVh("single-view",0===n.remoteStreams.length),e.R7$(9),e.Y8G("ngForOf",n.remoteStreams),e.R7$(),e.AVh("visible",n.showParticipants),e.R7$(3),e.SpI("Participants (",n.remoteStreams.length+1,")"),e.R7$(11),e.Y8G("ngForOf",n.remoteStreams),e.R7$(4),e.Y8G("name",n.isMicMuted?"mic-off":"mic"),e.R7$(2),e.JRh(n.isMicMuted?"Unmute":"Mute"),e.R7$(2),e.Y8G("name",n.isVideoEnabled?"videocam":"videocam-off"),e.R7$(2),e.JRh(n.isVideoEnabled?"Stop Video":"Start Video"),e.R7$(2),e.Y8G("name",n.isSharingScreen?"desktop":"desktop-outline"),e.R7$(2),e.JRh(n.isSharingScreen?"Stop Share":"Share Screen"))},dependencies:[b.Sq,b.bT,p.In,p.Jm,p.QW,p.W9,p.eU,p.iq,p.BC,p.ai],styles:['@charset "UTF-8";.meeting-container[_ngcontent-%COMP%]{--ion-background-color: #121212;color:#fff;height:100%;position:relative}.header-toolbar[_ngcontent-%COMP%]{--background: #1e1e1e;--color: white;--border-width: 0;box-shadow:0 2px 8px #0000004d}.meeting-title[_ngcontent-%COMP%]{font-weight:500;letter-spacing:.5px}.video-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:16px;padding:16px;height:calc(100% - 100px);align-content:center}.video-grid.single-view[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.video-grid.single-view[_ngcontent-%COMP%]   .video-item[_ngcontent-%COMP%]{max-width:800px;width:100%;height:auto}.video-item[_ngcontent-%COMP%]{position:relative;border-radius:12px;overflow:hidden;background:#2a2a2a;aspect-ratio:16/9;box-shadow:0 4px 12px #0003;transition:transform .2s ease}.video-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.video-container[_ngcontent-%COMP%]{width:100%;height:100%;position:relative}video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;background:#1a1a1a}.video-overlay[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;padding:12px;background:linear-gradient(to top,rgba(0,0,0,.7),transparent)}.user-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.peer-id[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#fff;text-shadow:0 1px 3px rgba(0,0,0,.5)}.status-indicators[_ngcontent-%COMP%]{display:flex;gap:8px}.status-indicators[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{background:#00000080;border-radius:50%;padding:4px;font-size:14px}.participants-panel[_ngcontent-%COMP%]{position:fixed;top:0;right:-100%;width:280px;height:100%;background:#1e1e1e;z-index:100;transition:right .3s ease;box-shadow:-5px 0 15px #0000004d;display:flex;flex-direction:column}.participants-panel.visible[_ngcontent-%COMP%]{right:0}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;border-bottom:1px solid rgba(255,255,255,.1)}.panel-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500}.participants-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px}.participant-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px;border-radius:8px;margin-bottom:4px;transition:background .2s ease}.participant-item[_ngcontent-%COMP%]:hover{background:#ffffff0d}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#ffffff1a;display:flex;align-items:center;justify-content:center;margin-right:12px}.avatar[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;color:#ffffffb3}.participant-details[_ngcontent-%COMP%]{flex:1}.participant-details[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;margin-bottom:2px}.status[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:12px;color:#fff9}.status-text[_ngcontent-%COMP%]{margin-right:8px}.status-dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;background:#ff5c5c}.status-dot.active[_ngcontent-%COMP%]{background:#4caf50}.meeting-controls[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;padding:12px 16px;background:#1e1e1e;display:flex;justify-content:center;border-top:1px solid rgba(255,255,255,.1)}.controls-container[_ngcontent-%COMP%]{display:flex;gap:8px;max-width:800px;width:100%;justify-content:center}.control-button[_ngcontent-%COMP%]{--background: transparent;--color: white;--border-radius: 8px;--padding-start: 12px;--padding-end: 12px;--padding-top: 8px;--padding-bottom: 8px;margin:0;flex-direction:column;font-size:12px}.control-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;margin-bottom:4px}.control-button.end-call[_ngcontent-%COMP%]{--background: rgba(239, 71, 67, .2);--color: #ef4743}.control-button[_ngcontent-%COMP%]:hover{--background: rgba(255, 255, 255, .1)}.button-label[_ngcontent-%COMP%]{font-size:12px;font-weight:500;margin-top:2px;margin-left:5px}.room-id-button[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .1);--border-radius: 20px;margin-left:8px}.room-id-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:6px;margin-bottom:0}.room-id-button[_ngcontent-%COMP%]   .button-label[_ngcontent-%COMP%]{margin-top:0}@media (max-width: 768px){.video-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;padding:8px;gap:8px}.video-item[_ngcontent-%COMP%]{aspect-ratio:4/3}.meeting-controls[_ngcontent-%COMP%]{flex-direction:column;padding:8px}.controls-container[_ngcontent-%COMP%]{gap:4px;flex-wrap:wrap}.control-button[_ngcontent-%COMP%]{--padding-start: 8px;--padding-end: 8px;font-size:10px;width:50px}.control-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.button-label[_ngcontent-%COMP%]{display:none}.participants-panel[_ngcontent-%COMP%]{width:100%;right:-100%}.participants-panel.visible[_ngcontent-%COMP%]{right:0}.participants-list[_ngcontent-%COMP%]{max-height:60vh;overflow-y:auto}}.mini-view[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;width:120px;height:160px;background:#000;border-radius:8px;overflow:hidden;z-index:1000;box-shadow:0 4px 16px #0000004d;cursor:pointer}.mini-view[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;opacity:.8}.mini-view-overlay[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;background:#000000b3;color:#fff;padding:8px;text-align:center;font-size:12px}.mini-view-overlay[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;display:block;margin:0 auto 4px}.participants-panel.visible[_ngcontent-%COMP%] ~ .mini-view[_ngcontent-%COMP%]{right:calc(50% + 10px);transform:translate(50%);bottom:20px}']}),l})()}];let I=(()=>{var i;class l{}return(i=l).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[h.iI.forChild(y),h.iI]}),l})(),V=(()=>{var i;class l{}return(i=l).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[b.MD,x.YN,p.bv,I]}),l})()}}]);